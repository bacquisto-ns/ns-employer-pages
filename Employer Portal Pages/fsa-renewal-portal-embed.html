<!-- FSA Renewal Portal - GHL Embeddable Version -->
<!-- This version is optimized for embedding into Go High Level platform -->
<!-- Wrap this entire content in a container div when embedding -->

<!-- Conditional CDN Resource Loading -->
<script>
(function() {
    'use strict';
    
    // Check and load Tailwind CSS if not already present
    if (typeof tailwind === 'undefined' && !document.querySelector('script[src*="tailwindcss"]')) {
        var tailwindScript = document.createElement('script');
        tailwindScript.src = 'https://cdn.tailwindcss.com';
        document.head.appendChild(tailwindScript);
    }
    
    // Check and load Font Awesome if not already present
    if (!document.querySelector('link[href*="font-awesome"]')) {
        var faLink = document.createElement('link');
        faLink.rel = 'stylesheet';
        faLink.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css';
        document.head.appendChild(faLink);
    }
    
    // Check and load Google Fonts if not already present
    if (!document.querySelector('link[href*="fonts.googleapis.com/css2?family=Inter"]')) {
        var fontLink = document.createElement('link');
        fontLink.rel = 'stylesheet';
        fontLink.href = 'https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap';
        document.head.appendChild(fontLink);
    }
    
    // Check and load Anime.js if not already present
    if (typeof anime === 'undefined' && !document.querySelector('script[src*="animejs"]')) {
        var animeScript = document.createElement('script');
        animeScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js';
        document.head.appendChild(animeScript);
    }
})();
</script>

<style>
    /* Scoped CSS Variables */
    .fsa-renewal-portal-wrapper {
        --fsa-primary-blue: #1E4E6B;
        --fsa-primary-blue-light: #2a5f7a;
        --fsa-accent-green: #A4C639;
        --fsa-accent-green-hover: #8fb332;
        --fsa-text-primary: #2d3748;
        --fsa-text-secondary: #64748b;
        --fsa-bg-primary: #f0f4f8;
        --fsa-bg-secondary: #e8f2f6;
        --fsa-bg-card: #ffffff;
        --fsa-border-default: #e2e8f0;
        --fsa-status-not-started: #94a3b8;
        --fsa-status-in-progress: #f59e0b;
        --fsa-status-submitted: #3b82f6;
        --fsa-status-complete: #10b981;
        --fsa-status-overdue: #ef4444;
        
        /* Isolation to prevent style leakage */
        isolation: isolate;
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: linear-gradient(135deg, var(--fsa-bg-primary) 0%, var(--fsa-bg-secondary) 100%);
        color: var(--fsa-text-primary);
        line-height: 1.6;
        box-sizing: border-box;
    }
    
    .fsa-renewal-portal-wrapper *,
    .fsa-renewal-portal-wrapper *::before,
    .fsa-renewal-portal-wrapper *::after {
        box-sizing: border-box;
    }
    
    .fsa-renewal-portal-wrapper .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
    }
    
    /* Header Styles */
    .fsa-renewal-portal-wrapper .header {
        background: linear-gradient(135deg, var(--fsa-primary-blue) 0%, var(--fsa-primary-blue-light) 100%);
        color: white;
        padding: 30px;
        border-radius: 16px 16px 0 0;
        margin-bottom: 30px;
        box-shadow: 0 8px 32px rgba(30, 78, 107, 0.2);
    }
    
    .fsa-renewal-portal-wrapper .breadcrumbs {
        font-size: 0.9rem;
        opacity: 0.9;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 15px;
    }
    
    .fsa-renewal-portal-wrapper .breadcrumbs a {
        color: white;
        text-decoration: none;
    }
    
    .fsa-renewal-portal-wrapper .breadcrumbs a:hover {
        text-decoration: underline;
    }
    
    .fsa-renewal-portal-wrapper .back-button {
        background: rgba(255, 255, 255, 0.2);
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.3);
        padding: 8px 16px;
        border-radius: 8px;
        font-size: 0.9rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        text-decoration: none;
    }
    
    .fsa-renewal-portal-wrapper .back-button:hover {
        background: rgba(255, 255, 255, 0.3);
        border-color: rgba(255, 255, 255, 0.5);
    }
    
    .fsa-renewal-portal-wrapper .back-button:focus {
        outline: 2px solid white;
        outline-offset: 2px;
    }
    
    .fsa-renewal-portal-wrapper .page-title {
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 15px;
    }
    
    .fsa-renewal-portal-wrapper .employer-pills {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 15px;
    }
    
    .fsa-renewal-portal-wrapper .pill {
        background: rgba(255, 255, 255, 0.2);
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.85rem;
        display: inline-flex;
        align-items: center;
        gap: 6px;
    }
    
    /* Summary Cards */
    .fsa-renewal-portal-wrapper .summary-cards {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
        margin-bottom: 30px;
    }
    
    .fsa-renewal-portal-wrapper .summary-card {
        background: var(--fsa-bg-card);
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        transition: all 0.3s ease;
        border-left: 4px solid var(--fsa-accent-green);
    }
    
    .fsa-renewal-portal-wrapper .summary-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
    }
    
    .fsa-renewal-portal-wrapper .summary-card-title {
        font-size: 0.85rem;
        color: var(--fsa-text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 8px;
    }
    
    .fsa-renewal-portal-wrapper .summary-card-value {
        font-size: 1.75rem;
        font-weight: 700;
        color: var(--fsa-text-primary);
    }
    
    .fsa-renewal-portal-wrapper .status-pill {
        display: inline-block;
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    .fsa-renewal-portal-wrapper .status-not-started {
        background: rgba(148, 163, 184, 0.2);
        color: var(--fsa-status-not-started);
    }
    
    .fsa-renewal-portal-wrapper .status-in-progress {
        background: rgba(245, 158, 11, 0.2);
        color: var(--fsa-status-in-progress);
    }
    
    .fsa-renewal-portal-wrapper .status-submitted {
        background: rgba(59, 130, 246, 0.2);
        color: var(--fsa-status-submitted);
    }
    
    .fsa-renewal-portal-wrapper .status-complete {
        background: rgba(16, 185, 129, 0.2);
        color: var(--fsa-status-complete);
    }
    
    .fsa-renewal-portal-wrapper .status-overdue {
        background: rgba(239, 68, 68, 0.2);
        color: var(--fsa-status-overdue);
    }
    
    .fsa-renewal-portal-wrapper .days-positive {
        color: var(--fsa-status-complete);
    }
    
    .fsa-renewal-portal-wrapper .days-warning {
        color: var(--fsa-status-in-progress);
    }
    
    .fsa-renewal-portal-wrapper .days-overdue {
        color: var(--fsa-status-overdue);
    }
    
    /* Tab Navigation */
    .fsa-renewal-portal-wrapper .tabs {
        background: var(--fsa-bg-card);
        border-radius: 12px;
        padding: 0;
        margin-bottom: 30px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        overflow: hidden;
    }
    
    .fsa-renewal-portal-wrapper .tab-list {
        display: flex;
        border-bottom: 2px solid var(--fsa-border-default);
        overflow-x: auto;
    }
    
    .fsa-renewal-portal-wrapper .tab-button {
        flex: 1;
        padding: 16px 24px;
        background: none;
        border: none;
        font-size: 1rem;
        font-weight: 600;
        color: var(--fsa-text-secondary);
        cursor: pointer;
        transition: all 0.3s ease;
        border-bottom: 3px solid transparent;
        position: relative;
    }
    
    .fsa-renewal-portal-wrapper .tab-button:hover {
        background: rgba(30, 78, 107, 0.05);
        color: var(--fsa-primary-blue);
    }
    
    .fsa-renewal-portal-wrapper .tab-button.active {
        color: var(--fsa-primary-blue);
        border-bottom-color: var(--fsa-accent-green);
    }
    
    .fsa-renewal-portal-wrapper .tab-content {
        display: none;
        padding: 30px;
    }
    
    .fsa-renewal-portal-wrapper .tab-content.active {
        display: block;
    }
    
    /* Content Cards */
    .fsa-renewal-portal-wrapper .content-card {
        background: var(--fsa-bg-card);
        border-radius: 12px;
        padding: 24px;
        margin-bottom: 20px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    }
    
    .fsa-renewal-portal-wrapper .content-card h3 {
        font-size: 1.3rem;
        font-weight: 600;
        color: var(--fsa-primary-blue);
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .fsa-renewal-portal-wrapper .info-table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .fsa-renewal-portal-wrapper .info-table td {
        padding: 12px 0;
        border-bottom: 1px solid var(--fsa-border-default);
    }
    
    .fsa-renewal-portal-wrapper .info-table td:first-child {
        font-weight: 600;
        color: var(--fsa-primary-blue);
        width: 40%;
    }
    
    .fsa-renewal-portal-wrapper .info-table tr:last-child td {
        border-bottom: none;
    }
    
    /* CTA Card */
    .fsa-renewal-portal-wrapper .cta-card {
        background: linear-gradient(135deg, rgba(30, 78, 107, 0.05) 0%, rgba(164, 198, 57, 0.05) 100%);
        border: 2px solid var(--fsa-accent-green);
        border-radius: 12px;
        padding: 30px;
        text-align: center;
        margin-bottom: 30px;
    }
    
    .fsa-renewal-portal-wrapper .cta-card h3 {
        font-size: 1.5rem;
        color: var(--fsa-primary-blue);
        margin-bottom: 10px;
    }
    
    .fsa-renewal-portal-wrapper .cta-card p {
        color: var(--fsa-text-secondary);
        margin-bottom: 20px;
    }
    
    .fsa-renewal-portal-wrapper .btn-primary {
        background: linear-gradient(135deg, var(--fsa-accent-green) 0%, var(--fsa-accent-green-hover) 100%);
        color: white;
        padding: 14px 32px;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(164, 198, 57, 0.3);
    }
    
    .fsa-renewal-portal-wrapper .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(164, 198, 57, 0.4);
    }
    
    .fsa-renewal-portal-wrapper .btn-primary:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
    }
    
    /* Form Styles */
    .fsa-renewal-portal-wrapper .form-section {
        display: none;
        margin-top: 30px;
    }
    
    .fsa-renewal-portal-wrapper .form-section.active {
        display: block;
    }
    
    .fsa-renewal-portal-wrapper .form-group {
        margin-bottom: 24px;
    }
    
    .fsa-renewal-portal-wrapper .form-label {
        display: block;
        font-weight: 500;
        margin-bottom: 8px;
        color: var(--fsa-text-primary);
    }
    
    .fsa-renewal-portal-wrapper .required {
        color: var(--fsa-status-overdue);
    }
    
    .fsa-renewal-portal-wrapper .form-input,
    .fsa-renewal-portal-wrapper .form-select,
    .fsa-renewal-portal-wrapper .form-textarea {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid var(--fsa-border-default);
        border-radius: 8px;
        font-size: 1rem;
        transition: all 0.3s ease;
        font-family: inherit;
    }
    
    .fsa-renewal-portal-wrapper .form-input:focus,
    .fsa-renewal-portal-wrapper .form-select:focus,
    .fsa-renewal-portal-wrapper .form-textarea:focus {
        outline: none;
        border-color: var(--fsa-accent-green);
        box-shadow: 0 0 0 3px rgba(164, 198, 57, 0.1);
    }
    
    .fsa-renewal-portal-wrapper .form-input.error,
    .fsa-renewal-portal-wrapper .form-select.error,
    .fsa-renewal-portal-wrapper .form-textarea.error {
        border-color: var(--fsa-status-overdue);
        box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
    }
    
    .fsa-renewal-portal-wrapper .error-message {
        color: var(--fsa-status-overdue);
        font-size: 0.875rem;
        margin-top: 4px;
    }
    
    .fsa-renewal-portal-wrapper .radio-group,
    .fsa-renewal-portal-wrapper .checkbox-group {
        display: flex;
        flex-direction: column;
        gap: 12px;
        margin-top: 8px;
    }
    
    .fsa-renewal-portal-wrapper .radio-option,
    .fsa-renewal-portal-wrapper .checkbox-option {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .fsa-renewal-portal-wrapper .radio-option input,
    .fsa-renewal-portal-wrapper .checkbox-option input {
        width: 18px;
        height: 18px;
        accent-color: var(--fsa-accent-green);
    }
    
    .fsa-renewal-portal-wrapper .conditional-field {
        display: none;
        margin-top: 16px;
        padding-left: 26px;
        border-left: 3px solid var(--fsa-accent-green);
    }
    
    .fsa-renewal-portal-wrapper .conditional-field.active {
        display: block;
    }
    
    .fsa-renewal-portal-wrapper .form-actions {
        display: flex;
        justify-content: space-between;
        margin-top: 30px;
        padding-top: 20px;
        border-top: 2px solid var(--fsa-border-default);
    }
    
    .fsa-renewal-portal-wrapper .btn-secondary {
        background: transparent;
        color: var(--fsa-primary-blue);
        border: 2px solid var(--fsa-primary-blue);
        padding: 12px 24px;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .fsa-renewal-portal-wrapper .btn-secondary:hover {
        background: var(--fsa-primary-blue);
        color: white;
    }
    
    /* History Timeline */
    .fsa-renewal-portal-wrapper .history-item {
        padding: 16px;
        border-left: 3px solid var(--fsa-accent-green);
        margin-bottom: 16px;
        background: rgba(164, 198, 57, 0.05);
        border-radius: 0 8px 8px 0;
    }
    
    .fsa-renewal-portal-wrapper .history-date {
        font-size: 0.85rem;
        color: var(--fsa-text-secondary);
        margin-bottom: 4px;
    }
    
    .fsa-renewal-portal-wrapper .history-event {
        font-weight: 600;
        color: var(--fsa-primary-blue);
        margin-bottom: 4px;
    }
    
    .fsa-renewal-portal-wrapper .history-description {
        font-size: 0.9rem;
        color: var(--fsa-text-secondary);
    }
    
    /* Contact List */
    .fsa-renewal-portal-wrapper .contact-item {
        padding: 16px;
        border-bottom: 1px solid var(--fsa-border-default);
    }
    
    .fsa-renewal-portal-wrapper .contact-item:last-child {
        border-bottom: none;
    }
    
    .fsa-renewal-portal-wrapper .contact-name {
        font-weight: 600;
        color: var(--fsa-primary-blue);
        margin-bottom: 4px;
    }
    
    .fsa-renewal-portal-wrapper .contact-role {
        font-size: 0.9rem;
        color: var(--fsa-text-secondary);
        margin-bottom: 8px;
    }
    
    .fsa-renewal-portal-wrapper .contact-info {
        font-size: 0.9rem;
        color: var(--fsa-text-secondary);
    }
    
    /* Document Table */
    .fsa-renewal-portal-wrapper .document-table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .fsa-renewal-portal-wrapper .document-table th,
    .fsa-renewal-portal-wrapper .document-table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid var(--fsa-border-default);
    }
    
    .fsa-renewal-portal-wrapper .document-table th {
        font-weight: 600;
        color: var(--fsa-primary-blue);
        background: rgba(30, 78, 107, 0.05);
    }
    
    .fsa-renewal-portal-wrapper .document-table tr:hover {
        background: rgba(164, 198, 57, 0.05);
    }
    
    /* Review Summary */
    .fsa-renewal-portal-wrapper .review-summary {
        background: rgba(30, 78, 107, 0.05);
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
    }
    
    .fsa-renewal-portal-wrapper .review-item {
        margin-bottom: 12px;
    }
    
    .fsa-renewal-portal-wrapper .review-label {
        font-weight: 600;
        color: var(--fsa-primary-blue);
        margin-bottom: 4px;
    }
    
    .fsa-renewal-portal-wrapper .review-value {
        color: var(--fsa-text-primary);
    }
    
    /* File Upload Placeholder */
    .fsa-renewal-portal-wrapper .file-upload-placeholder {
        padding: 20px;
        border: 2px dashed var(--fsa-border-default);
        border-radius: 8px;
        text-align: center;
        color: var(--fsa-text-secondary);
        background: rgba(164, 198, 57, 0.05);
    }
    
    /* Responsive */
    @media (max-width: 1024px) {
        .fsa-renewal-portal-wrapper .summary-cards {
            grid-template-columns: repeat(2, 1fr);
        }
    }
    
    @media (max-width: 768px) {
        .fsa-renewal-portal-wrapper .container {
            padding: 10px;
        }
        
        .fsa-renewal-portal-wrapper .summary-cards {
            grid-template-columns: 1fr;
        }
        
        .fsa-renewal-portal-wrapper .tab-list {
            flex-wrap: nowrap;
            overflow-x: auto;
        }
        
        .fsa-renewal-portal-wrapper .tab-button {
            white-space: nowrap;
            min-width: 120px;
        }
        
        .fsa-renewal-portal-wrapper .form-actions {
            flex-direction: column;
            gap: 12px;
        }
        
        .fsa-renewal-portal-wrapper .btn-primary,
        .fsa-renewal-portal-wrapper .btn-secondary {
            width: 100%;
        }
    }
    
    /* Accessibility */
    .fsa-renewal-portal-wrapper .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
    }
    
    @media (prefers-reduced-motion: reduce) {
        .fsa-renewal-portal-wrapper * {
            animation: none !important;
            transition: none !important;
        }
    }
    
    /* Animations */
    .fsa-renewal-portal-wrapper .fade-in {
        opacity: 0;
        animation: fsaFadeIn 0.6s ease-out forwards;
    }
    
    @keyframes fsaFadeIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>

<div class="fsa-renewal-portal-wrapper">
    <div class="container">
        <!-- Header -->
        <header class="header fade-in" role="banner">
            <nav class="breadcrumbs" aria-label="Breadcrumb">
                <button class="back-button" id="fsa-renewal-backButton" aria-label="Go back to previous page">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
            </nav>
            <h1 class="page-title" id="fsa-renewal-pageTitle">{{ location.name }}</h1>
            <div class="employer-pills">
                <span class="pill"><i class="fas fa-industry"></i> <span id="fsa-renewal-industry">Healthcare</span></span>
                <span class="pill"><i class="fas fa-users"></i> <span id="fsa-renewal-employeeCount">{{ custom_values.ee }}</span> Employees</span>
                <span class="pill"><i class="fas fa-handshake"></i> Broker: <span id="fsa-renewal-broker">{{ custom_values.broker_full_name }}</span></span>
            </div>
        </header>
        
        <!-- Summary Cards -->
        <div class="summary-cards fade-in" id="fsa-renewal-summaryCards">
            <div class="summary-card">
                <div class="summary-card-title">Renewal Status</div>
                <div class="summary-card-value">
                    <span class="status-pill" id="fsa-renewal-statusPill">Not Started</span>
                </div>
            </div>
            <div class="summary-card">
                <div class="summary-card-title">Days Until Due</div>
                <div class="summary-card-value" id="fsa-renewal-daysUntilDue"> {{custom_values.fsa_days_until_due}} </div>
            </div>
            <div class="summary-card">
                <div class="summary-card-title">Process Stage</div>
                <div class="summary-card-value" id="fsa-renewal-processStage"> {{custom_values.fsa_processing_stage}} </div>
            </div>
            <div class="summary-card">
                <div class="summary-card-title">Plan End Date</div>
                <div class="summary-card-value" id="fsa-renewal-planEndDate"> {{custom_values.fsa_pyend}} </div>
            </div>
        </div>
        
        <!-- Tab Navigation -->
        <nav class="tabs fade-in" role="tablist" aria-label="FSA Renewal Portal Tabs">
            <div class="tab-list">
                <button class="tab-button active" data-tab="overview" role="tab" aria-selected="true" aria-controls="fsa-renewal-overview-panel">
                    Overview
                </button>
                <button class="tab-button" data-tab="renewal-details" role="tab" aria-selected="false" aria-controls="fsa-renewal-renewal-details-panel">
                    Renewal Details
                </button>
                <button class="tab-button" data-tab="contacts" role="tab" aria-selected="false" aria-controls="fsa-renewal-contacts-panel">
                    Contacts
                </button>
                <button class="tab-button" data-tab="documents" role="tab" aria-selected="false" aria-controls="fsa-renewal-documents-panel">
                    Documents
                </button>
                <button class="tab-button" data-tab="history" role="tab" aria-selected="false" aria-controls="fsa-renewal-history-panel">
                    History
                </button>
            </div>
            
            <!-- Overview Tab -->
            <div id="fsa-renewal-overview-panel" class="tab-content active" role="tabpanel" aria-labelledby="fsa-renewal-overview-tab">
                <div class="content-card">
                    <h3><i class="fas fa-info-circle"></i> Basic Information</h3>
                    <table class="info-table">
                        <tr>
                            <td>Group Name</td>
                            <td id="fsa-renewal-infoGroupName">--</td>
                        </tr>
                        <tr>
                            <td>Industry</td>
                            <td id="fsa-renewal-infoIndustry">--</td>
                        </tr>
                        <tr>
                            <td>Employee Count</td>
                            <td id="fsa-renewal-infoEmployeeCount">--</td>
                        </tr>
                        <tr>
                            <td>Assigned Broker</td>
                            <td id="fsa-renewal-infoBroker">--</td>
                        </tr>
                        <tr>
                            <td>Address</td>
                            <td id="fsa-renewal-infoAddress">--</td>
                        </tr>
                    </table>
                </div>
                
                <div class="cta-card">
                    <h3>FSA Renewal</h3>
                    <p id="fsa-renewal-ctaDescription">Complete your FSA renewal form to continue your benefits for the upcoming plan year.</p>
                    <a href="https://nuesynergy.com" class="btn-primary" id="fsa-renewal-ctaButton" style="text-decoration: none; display: inline-block;">
                        Start FSA Renewal
                    </a>
                </div>
            </div>
            
            <!-- Renewal Details Tab -->
            <div id="fsa-renewal-renewal-details-panel" class="tab-content" role="tabpanel" aria-labelledby="fsa-renewal-renewal-details-tab">
                <div class="content-card">
                    <h3><i class="fas fa-clipboard-list"></i> Renewal Information</h3>
                    <table class="info-table">
                        <tr>
                            <td>Renewal Status</td>
                            <td id="fsa-renewal-detailStatus">--</td>
                        </tr>
                        <tr>
                            <td>Process Stage</td>
                            <td id="fsa-renewal-detailProcessStage">--</td>
                        </tr>
                        <tr>
                            <td>Renewal Due Date</td>
                            <td id="fsa-renewal-detailDueDate">--</td>
                        </tr>
                        <tr>
                            <td>Renewal Effective Date</td>
                            <td id="fsa-renewal-detailEffectiveDate">--</td>
                        </tr>
                        <tr>
                            <td>Current Plan Start</td>
                            <td id="fsa-renewal-detailPlanStart">--</td>
                        </tr>
                        <tr>
                            <td>Current Plan End</td>
                            <td id="fsa-renewal-detailPlanEnd">--</td>
                        </tr>
                        <tr>
                            <td>Last Activity</td>
                            <td id="fsa-renewal-detailLastActivity">--</td>
                        </tr>
                        <tr>
                            <td>Next Follow-up</td>
                            <td id="fsa-renewal-detailNextFollowUp">--</td>
                        </tr>
                    </table>
                </div>
            </div>
            
            <!-- Contacts Tab -->
            <div id="fsa-renewal-contacts-panel" class="tab-content" role="tabpanel" aria-labelledby="fsa-renewal-contacts-tab">
                <div class="content-card">
                    <h3><i class="fas fa-address-book"></i> Key Contacts</h3>
                    <div id="fsa-renewal-contactsList"></div>
                </div>
            </div>
            
            <!-- Documents Tab -->
            <div id="fsa-renewal-documents-panel" class="tab-content" role="tabpanel" aria-labelledby="fsa-renewal-documents-tab">
                <div class="content-card">
                    <h3><i class="fas fa-file-alt"></i> Documents</h3>
                    <table class="document-table">
                        <thead>
                            <tr>
                                <th>Document Name</th>
                                <th>Uploaded Date</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="fsa-renewal-documentsList">
                            <tr>
                                <td>Current Plan Documents</td>
                                <td>--</td>
                                <td><a href="#" style="color: var(--fsa-accent-green);">Download</a></td>
                            </tr>
                            <tr>
                                <td>Prior Year Submission</td>
                                <td>--</td>
                                <td><a href="#" style="color: var(--fsa-accent-green);">Download</a></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- History Tab -->
            <div id="fsa-renewal-history-panel" class="tab-content" role="tabpanel" aria-labelledby="fsa-renewal-history-tab">
                <div class="content-card">
                    <h3><i class="fas fa-history"></i> Activity History</h3>
                    <div id="fsa-renewal-historyList"></div>
                </div>
            </div>
        </nav>
    </div>
    
    <!-- Screen Reader Announcements -->
    <div id="fsa-renewal-status-message" class="sr-only" role="status" aria-live="polite"></div>
    <div id="fsa-renewal-error-message" class="sr-only" role="alert" aria-live="assertive"></div>
</div>

<script>
(function() {
    'use strict';
    
    // Find wrapper element
    const wrapper = document.querySelector('.fsa-renewal-portal-wrapper');
    if (!wrapper) {
        console.error('FSA Renewal Portal: Wrapper element not found');
        return;
    }
    
    // Mock Data (matches PRD Section 7)
    const mockData = {
        employer: {
            id: "springfield-manufacturing",
            name: "Springfield Manufacturing",
            industry: "Manufacturing",
            employeeCount: 85,
            broker: "Brian Acquisto",
            address: {
                line1: "456 Industrial Rd",
                city: "Springfield",
                state: "MO",
                zip: "65802",
                country: "USA"
            }
        },
        fsaRenewal: {
            renewalStatus: "IN_PROGRESS",
            processStage: "Census & Data Collection",
            renewalDueDate: "2026-04-19",
            currentPlanStart: "2025-06-23",
            currentPlanEnd: null,
            renewalEffectiveDate: null,
            lastActivity: null,
            nextFollowUp: null
        },
        contacts: [
            {
                name: "Jane Doe",
                role: "HR Manager",
                email: "jane.doe@springfield.com",
                phone: "(555) 123-4567"
            },
            {
                name: "John Smith",
                role: "Benefits Coordinator",
                email: "john.smith@springfield.com",
                phone: "(555) 123-4568"
            }
        ],
        documents: [
            {
                name: "Current Plan Documents",
                uploadedDate: "2025-01-15"
            },
            {
                name: "Prior Year Submission",
                uploadedDate: "2024-04-10"
            }
        ],
        history: []
    };
    
    // Application State
    let appState = {
        currentTab: 'overview',
        history: []
    };
    
    // Helper function to get element by ID scoped to wrapper
    function getElement(id) {
        return wrapper.querySelector('#' + id);
    }
    
    // Helper function to get elements scoped to wrapper
    function getElements(selector) {
        return wrapper.querySelectorAll(selector);
    }
    
    // Initialize on DOM ready
    function init() {
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializePortal);
        } else {
            initializePortal();
        }
    }
    
    function initializePortal() {
        initializeData();
        setupEventListeners();
        updateDisplay();
        announceToScreenReader('FSA Renewal Portal loaded');
        
        // Initialize animations after a short delay to ensure anime.js is loaded
        setTimeout(initializeAnimations, 100);
    }
    
    // Initialize data display
    function initializeData() {
        // Set employer info
        const groupNameEl = getElement('fsa-renewal-groupName');
        const pageTitleEl = getElement('fsa-renewal-pageTitle');
        const industryEl = getElement('fsa-renewal-industry');
        const employeeCountEl = getElement('fsa-renewal-employeeCount');
        const brokerEl = getElement('fsa-renewal-broker');
        
        if (groupNameEl) groupNameEl.textContent = mockData.employer.name;
        if (pageTitleEl) pageTitleEl.textContent = mockData.employer.name;
        if (industryEl) industryEl.textContent = mockData.employer.industry;
        if (employeeCountEl) employeeCountEl.textContent = mockData.employer.employeeCount;
        if (brokerEl) brokerEl.textContent = mockData.employer.broker;
        
        // Set basic info
        const infoGroupNameEl = getElement('fsa-renewal-infoGroupName');
        const infoIndustryEl = getElement('fsa-renewal-infoIndustry');
        const infoEmployeeCountEl = getElement('fsa-renewal-infoEmployeeCount');
        const infoBrokerEl = getElement('fsa-renewal-infoBroker');
        const infoAddressEl = getElement('fsa-renewal-infoAddress');
        
        if (infoGroupNameEl) infoGroupNameEl.textContent = mockData.employer.name;
        if (infoIndustryEl) infoIndustryEl.textContent = mockData.employer.industry;
        if (infoEmployeeCountEl) infoEmployeeCountEl.textContent = mockData.employer.employeeCount;
        if (infoBrokerEl) infoBrokerEl.textContent = mockData.employer.broker;
        if (infoAddressEl) {
            infoAddressEl.textContent = 
                `${mockData.employer.address.line1}, ${mockData.employer.address.city}, ${mockData.employer.address.state} ${mockData.employer.address.zip}`;
        }
        
        // Set renewal details
        const detailStatusEl = getElement('fsa-renewal-detailStatus');
        const detailProcessStageEl = getElement('fsa-renewal-detailProcessStage');
        const detailDueDateEl = getElement('fsa-renewal-detailDueDate');
        const detailEffectiveDateEl = getElement('fsa-renewal-detailEffectiveDate');
        const detailPlanStartEl = getElement('fsa-renewal-detailPlanStart');
        const detailPlanEndEl = getElement('fsa-renewal-detailPlanEnd');
        const detailLastActivityEl = getElement('fsa-renewal-detailLastActivity');
        const detailNextFollowUpEl = getElement('fsa-renewal-detailNextFollowUp');
        
        if (detailStatusEl) detailStatusEl.textContent = formatStatus(mockData.fsaRenewal.renewalStatus);
        if (detailProcessStageEl) detailProcessStageEl.textContent = mockData.fsaRenewal.processStage || '--';
        if (detailDueDateEl) detailDueDateEl.textContent = formatDate(mockData.fsaRenewal.renewalDueDate) || '--';
        if (detailEffectiveDateEl) detailEffectiveDateEl.textContent = formatDate(mockData.fsaRenewal.renewalEffectiveDate) || '--';
        if (detailPlanStartEl) detailPlanStartEl.textContent = formatDate(mockData.fsaRenewal.currentPlanStart) || '--';
        if (detailPlanEndEl) detailPlanEndEl.textContent = formatDate(mockData.fsaRenewal.currentPlanEnd) || '--';
        if (detailLastActivityEl) detailLastActivityEl.textContent = formatDate(mockData.fsaRenewal.lastActivity) || '--';
        if (detailNextFollowUpEl) detailNextFollowUpEl.textContent = formatDate(mockData.fsaRenewal.nextFollowUp) || '--';
        
        // Render contacts
        renderContacts();
        
        // Render documents
        renderDocuments();
        
        // Render history
        renderHistory();
    }
    
    // Setup event listeners
    function setupEventListeners() {
        // Tab switching
        getElements('.tab-button').forEach(button => {
            button.addEventListener('click', function() {
                switchTab(this.dataset.tab);
            });
        });
        
        // Back button
        const backButton = getElement('fsa-renewal-backButton');
        if (backButton) {
            backButton.addEventListener('click', function() {
                if (window.history.length > 1) {
                    window.history.back();
                } else {
                    // Fallback: navigate to a default page if no history
                    window.location.href = '#';
                }
            });
        }
    }
    
    // Tab switching
    function switchTab(tabName) {
        appState.currentTab = tabName;
        
        // Update tab buttons
        getElements('.tab-button').forEach(btn => {
            btn.classList.remove('active');
            btn.setAttribute('aria-selected', 'false');
            if (btn.dataset.tab === tabName) {
                btn.classList.add('active');
                btn.setAttribute('aria-selected', 'true');
            }
        });
        
        // Update tab panels
        getElements('.tab-content').forEach(panel => {
            panel.classList.remove('active');
            if (panel.id === `fsa-renewal-${tabName}-panel`) {
                panel.classList.add('active');
            }
        });
        
        announceToScreenReader(`Switched to ${tabName} tab`);
    }
    
    // Calculate days until due
    function calculateDaysUntilDue() {
        const dueDate = new Date(mockData.fsaRenewal.renewalDueDate);
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        dueDate.setHours(0, 0, 0, 0);
        
        const diffTime = dueDate - today;
        const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
        
        return diffDays;
    }
    
    // Compute status
    function computeStatus() {
        // Priority order: COMPLETE > SUBMITTED > OVERDUE > IN_PROGRESS > NOT_STARTED
        if (mockData.fsaRenewal.renewalStatus === 'COMPLETE') {
            return 'COMPLETE';
        }
        
        // Use the status from mockData
        return mockData.fsaRenewal.renewalStatus || 'NOT_STARTED';
    }
    
    // Format status for display
    function formatStatus(status) {
        const statusMap = {
            'NOT_STARTED': 'Not Started',
            'IN_PROGRESS': 'In Progress',
            'SUBMITTED': 'Submitted',
            'COMPLETE': 'Complete',
            'OVERDUE': 'Overdue'
        };
        return statusMap[status] || status;
    }
    
    // Format date
    function formatDate(dateString) {
        if (!dateString) return null;
        const date = new Date(dateString);
        return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
    }
    
    // Update display
    function updateDisplay() {
        const status = computeStatus();
        
        // Update status pill
        const statusPill = getElement('fsa-renewal-statusPill');
        if (statusPill) {
            statusPill.textContent = formatStatus(status);
            statusPill.className = 'status-pill status-' + status.toLowerCase().replace('_', '-');
        }
        
        // Update renewal details tab status
        const detailStatusEl = getElement('fsa-renewal-detailStatus');
        if (detailStatusEl) detailStatusEl.textContent = formatStatus(status);
        
        // Update days until due
        const daysUntilDue = calculateDaysUntilDue();
        const daysElement = getElement('fsa-renewal-daysUntilDue');
        if (daysElement) {
            if (daysUntilDue > 0) {
                daysElement.textContent = `${daysUntilDue} day${daysUntilDue !== 1 ? 's' : ''}`;
                daysElement.className = 'summary-card-value days-positive';
            } else if (daysUntilDue === 0) {
                daysElement.textContent = 'Due today';
                daysElement.className = 'summary-card-value days-warning';
            } else {
                daysElement.textContent = `${Math.abs(daysUntilDue)} day${Math.abs(daysUntilDue) !== 1 ? 's' : ''} overdue`;
                daysElement.className = 'summary-card-value days-overdue';
            }
        }
        
        // Update process stage
        const processStageEl = getElement('fsa-renewal-processStage');
        if (processStageEl) processStageEl.textContent = mockData.fsaRenewal.processStage || '--';
        
        // Update plan end date
        const planEndDateEl = getElement('fsa-renewal-planEndDate');
        if (planEndDateEl) planEndDateEl.textContent = formatDate(mockData.fsaRenewal.currentPlanEnd) || '--';
        
        // Update CTA button
        updateCTAButton();
    }
    
    // Update CTA button
    function updateCTAButton() {
        const status = computeStatus();
        const button = getElement('fsa-renewal-ctaButton');
        const description = getElement('fsa-renewal-ctaDescription');
        
        if (!button || !description) return;
        
        if (status === 'NOT_STARTED') {
            button.textContent = 'Start FSA Renewal';
            button.href = 'https://nuesynergy.com';
            description.textContent = 'Complete your FSA renewal form to continue your benefits for the upcoming plan year.';
        } else if (status === 'IN_PROGRESS') {
            button.textContent = 'Continue FSA Renewal';
            button.href = 'https://nstestco.nuesynergyinfo.com/fsa-renewal-123579098';
            description.textContent = 'Continue filling out your renewal form.';
        } else if (status === 'SUBMITTED') {
            button.textContent = 'View Submission';
            button.href = 'https://nuesynergy.com';
            description.textContent = 'Your renewal has been submitted. View your submission details.';
        } else if (status === 'COMPLETE') {
            button.textContent = 'View Submission';
            button.href = 'https://nuesynergy.com';
            description.textContent = 'Your renewal has been processed and completed.';
        } else if (status === 'OVERDUE') {
            button.textContent = 'Submit Renewal';
            button.href = 'https://nstestco.nuesynergyinfo.com/fsa-renewal-123579098';
            description.textContent = 'Your renewal is overdue. Please submit your form as soon as possible.';
        }
    }
    
    // Log history event
    function logHistoryEvent(eventType, description) {
        const event = {
            date: new Date().toISOString(),
            type: eventType,
            description: description
        };
        
        appState.history.unshift(event);
        
        // Keep only last 50 events
        if (appState.history.length > 50) {
            appState.history = appState.history.slice(0, 50);
        }
        
        // Save to localStorage with prefixed key
        try {
            localStorage.setItem(`fsa-renewal-${mockData.employer.id}-history`, JSON.stringify(appState.history));
        } catch (e) {
            console.warn('FSA Renewal Portal: Could not save to localStorage', e);
        }
        
        // Update display
        renderHistory();
    }
    
    // Render contacts
    function renderContacts() {
        const container = getElement('fsa-renewal-contactsList');
        if (!container) return;
        
        if (mockData.contacts.length === 0) {
            container.innerHTML = '<p style="color: var(--fsa-text-secondary);">No contacts available.</p>';
            return;
        }
        
        container.innerHTML = mockData.contacts.map(contact => `
            <div class="contact-item">
                <div class="contact-name">${contact.name}</div>
                <div class="contact-role">${contact.role}</div>
                <div class="contact-info">
                    <i class="fas fa-envelope"></i> ${contact.email}<br>
                    <i class="fas fa-phone"></i> ${contact.phone}
                </div>
            </div>
        `).join('');
    }
    
    // Render documents
    function renderDocuments() {
        const tbody = getElement('fsa-renewal-documentsList');
        if (!tbody) return;
        
        tbody.innerHTML = mockData.documents.map(doc => `
            <tr>
                <td>${doc.name}</td>
                <td>${formatDate(doc.uploadedDate) || '--'}</td>
                <td><a href="#" style="color: var(--fsa-accent-green);">Download</a></td>
            </tr>
        `).join('');
    }
    
    // Render history
    function renderHistory() {
        const container = getElement('fsa-renewal-historyList');
        if (!container) return;
        
        const allHistory = [...appState.history, ...mockData.history];
        
        if (allHistory.length === 0) {
            container.innerHTML = '<p style="color: var(--fsa-text-secondary);">No history available.</p>';
            return;
        }
        
        // Sort by date (newest first)
        allHistory.sort((a, b) => new Date(b.date) - new Date(a.date));
        
        container.innerHTML = allHistory.map(item => `
            <div class="history-item">
                <div class="history-date">${formatDateTime(item.date)}</div>
                <div class="history-event">${formatEventType(item.type)}</div>
                <div class="history-description">${item.description}</div>
            </div>
        `).join('');
    }
    
    // Format date time
    function formatDateTime(dateString) {
        const date = new Date(dateString);
        return date.toLocaleString('en-US', { 
            year: 'numeric', 
            month: 'short', 
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        });
    }
    
    // Format event type
    function formatEventType(type) {
        const typeMap = {
            'FORM_STARTED': 'Form Started',
            'FORM_SAVED': 'Form Saved',
            'FORM_SUBMITTED': 'Form Submitted',
            'STATUS_UPDATED': 'Status Updated'
        };
        return typeMap[type] || type;
    }
    
    // Screen reader announcements
    function announceToScreenReader(message) {
        const statusEl = getElement('fsa-renewal-status-message');
        if (statusEl) {
            statusEl.textContent = message;
            setTimeout(() => {
                statusEl.textContent = '';
            }, 1000);
        }
    }
    
    function announceError(message) {
        const errorEl = getElement('fsa-renewal-error-message');
        if (errorEl) {
            errorEl.textContent = message;
            setTimeout(() => {
                errorEl.textContent = '';
            }, 2000);
        }
    }
    
    // Initialize animations
    function initializeAnimations() {
        if (typeof anime !== 'undefined') {
            anime({
                targets: wrapper.querySelectorAll('.fade-in'),
                opacity: [0, 1],
                translateY: [20, 0],
                delay: anime.stagger(100),
                duration: 800,
                easing: 'easeOutExpo'
            });
        }
    }
    
    // Start initialization
    init();
})();
</script>

